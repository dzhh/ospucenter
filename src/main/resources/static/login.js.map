{"version":3,"sources":["webpack:///./app/style/login.less","webpack:///./app/containers/App/login.js","webpack:///./app/style/login.less?c80c"],"names":["FormItem","Item","webStyle","width","height","backgroundImage","Login","state","props","config","loginResponse","logout","dispatch","actions","create","onFieldsChange","items","context","loading","handleSubmit","bind","handleChange","checkPass","checkName","noop","e","preventDefault","form","validateFields","err","values","setState","re","map","key","trim","res","console","log","data","token","ospState","sessionStorage","setItem","ucUser","userName","userId","menuTrees","push","warning","msg","newState","target","name","value","rule","callback","getFieldDecorator","maxWidth","rules","required","message","validator","pattern","fontSize","valuePropName","initialValue","float"],"mappings":"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","file":"login.js","sourcesContent":["exports = module.exports = require(\"../../node_modules/css-loader/lib/css-base.js\")();\n// imports\n\n\n// module\nexports.push([module.id, \".login {\\n  display: flex;\\n  justify-content: center;\\n  align-items: center;\\n  height: 100%;\\n  background: #f3f3f3;\\n}\\n.login .login-form {\\n  width: 320px;\\n  height: 340px;\\n  padding: 36px;\\n  box-shadow: 0 0 100px rgba(0, 0, 0, 0.08);\\n  background: #fff;\\n}\\n.login .login-form .login-logo {\\n  text-align: center;\\n  height: 40px;\\n  line-height: 40px;\\n  cursor: pointer;\\n  margin-bottom: 24px;\\n}\\n.login .login-form .login-logo span {\\n  vertical-align: text-bottom;\\n  font-size: 16px;\\n  text-transform: uppercase;\\n  display: inline-block;\\n}\\n\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/css-loader!./~/postcss-loader!./~/less-loader!./app/style/login.less\n// module id = 891\n// module chunks = 12","\r\nimport React, { Component } from 'react'\r\nimport { bindActionCreators } from 'redux'\r\nimport { connect } from 'react-redux'\r\nimport { hashHistory } from 'react-router'\r\nimport { Checkbox,Spin, message, Form, Icon, Input, Button, Row, Col } from 'antd'\r\n// import { fetchLogin, receiveLogin } from '../../actions/login'\r\nimport { fetchLogin } from '../../ajax/login'\r\nimport imgUrlWeb from '../../images/leftBg.jpg'\r\nimport { routerActions } from 'react-router-redux'\r\nimport '../../style/login.less'\r\nimport {changeLogout } from '../../actions/login'\r\nimport { deleteAllTab } from '../../actions/tabList'\r\n\r\nimport {\r\n     logOut\r\n} from '../../utils'\r\nconst FormItem = Form.Item\r\nvar webStyle = {\r\n    // backgroundImage: `url(${imgUrlWeb})`\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    backgroundImage: \"url('\"+imgUrlWeb+\"')\"\r\n};\r\n//连接 Redux 的组件 不可复用\r\n@connect(\r\n  (state, props) => ({\r\n    config: state.config,\r\n    loginResponse: state.loginResponse,\r\n    logout:state.logout,\r\n  }),\r\n    (dispatch) => ({ actions: bindActionCreators(routerActions, dispatch),\r\n        dispatch: dispatch })\r\n)\r\n//测试为 在每输入一个字符时调用\r\n@Form.create({\r\n  onFieldsChange(props, items) {\r\n    // console.log(items)\r\n    // props.cacheSearch(items);\r\n  },\r\n})\r\n\r\nexport default class Login extends Component {\r\n  // 初始化页面常量 绑定事件方法\r\n  constructor(props, context) {\r\n    super(props)\r\n    this.state = {\r\n      //为true时  登陆页面一直加载\r\n      loading: false,\r\n    }\r\n    this.handleSubmit = this.handleSubmit.bind(this)\r\n    this.handleChange = this.handleChange.bind(this)\r\n    this.checkPass = this.checkPass.bind(this)\r\n    this.checkName = this.checkName.bind(this)\r\n    this.noop = this.noop.bind(this)\r\n  }\r\n    componentWillMount() {\r\n        const {dispatch} = this.props\r\n        dispatch(deleteAllTab());\r\n      //  dispatch(changeLogout())\r\n    }\r\n  handleSubmit(e) {\r\n    e.preventDefault()\r\n    this.props.form.validateFields((err, values) => {\r\n      if (!err) {\r\n        this.state.loading = true\r\n         this.setState({loading: true})\r\n        const re={} ;\r\n        Object.keys(values).map((key) => values[key] = (\r\n            values[key] && typeof(values[key]) =='string'&&values[key].trim()\r\n        ))\r\n          //请求后台数据  派发事件 放到回调里面\r\n        fetchLogin(values, (res) => {\r\n            console.log(\"res1\"+res.data);\r\n            console.log(\"res2\"+res.token);\r\n            // this.props.dispatch(fetchLogin(values, (res) => {\r\n            if (res.ospState == 200) {\r\n                //const query = this.props.form.getFieldsValue()\r\n                sessionStorage.setItem('userName', res.data.ucUser.userName)\r\n                sessionStorage.setItem('userId', res.data.ucUser.userId)\r\n                sessionStorage.setItem('menus', JSON.stringify(res.data.menuTrees))\r\n                //this.dealMenu(res.data.menuTrees)\r\n\r\n                sessionStorage.setItem('token', res.token)\r\n                sessionStorage.setItem('isLeftNavMini', false)\r\n                //this.props.config.WEBDATA.login=true\r\n               // this.props.dispatch(changeLogout());\r\n                // this.props.dispatch(receiveLogin({ req: data, res: resp }))\r\n                hashHistory.push('/')\r\n            } else  if (res.ospState == 401){\r\n\r\n                message.warning(\"账号或密码错误\")\r\n                this.setState({\r\n                    loading: false\r\n                })\r\n            }else {\r\n                message.warning(res.data.msg)\r\n                this.setState({\r\n                    loading: false\r\n                })\r\n            }\r\n        })\r\n      }\r\n    })\r\n  }\r\n\r\n\r\n  handleChange(e) {\r\n    const newState = {}\r\n    newState[e.target.name] = e.target.value\r\n    this.setState(newState)\r\n  }\r\n\r\n  // 组件已经加载到dom中\r\n  componentDidMount() {\r\n    // this.props.dispatch(fetchLogin({ currentPage: 1 }))\r\n  }\r\n\r\n  checkName(rule, value, callback) {\r\n    const { validateFields } = this.props.form\r\n    if (value) {\r\n      // validateFields([''])\r\n    }\r\n    callback()\r\n  }\r\n\r\n  checkPass(rule, value, callback) {\r\n    const { validateFields } = this.props.form\r\n    if (value) {\r\n      // validateFields([''])\r\n    }\r\n    callback()\r\n  }\r\n\r\n  noop() {\r\n    return false\r\n  }\r\n\r\n  render() {\r\n    const { loginResponse } = this.props.loginResponse\r\n    const { getFieldDecorator } = this.props.form\r\n      return (\r\n          <div className=\"login\" style={webStyle}>\r\n              <div className=\"login-form\">\r\n\r\n                  <div className=\"login-logo\">\r\n                      <span>欢迎登陆</span>\r\n                  </div>\r\n                  <Form onSubmit={this.handleSubmit} style={{maxWidth: '300px'}}>\r\n                      <FormItem hasFeedback>\r\n                          {getFieldDecorator('userName', {\r\n                              rules: [\r\n                                  { required: true, message: '请输入用户名' },\r\n                                  { validator: this.checkName },\r\n                                  // { pattern: regExpConfig.IDcardTrim, message: '身份证号格式不正确' }\r\n                                  { pattern: \"[A-Za-z0-9]{5,8}\", message: '用户名只能为5-8位字符或数字' }\r\n                              ],\r\n                              //validateTrigger: 'onBlur',\r\n                          })(\r\n                              <Input\r\n                                  prefix={<Icon type=\"user\" style={{ fontSize: 13 }} />}\r\n                                  placeholder=\"请输入用户名\"\r\n                                  type=\"text\"\r\n                              />\r\n                          )}\r\n                      </FormItem>\r\n                      <FormItem hasFeedback>\r\n                          {getFieldDecorator('userPwd', {\r\n                              rules: [\r\n                                  { required: true, message: '请输入密码' },\r\n                                  //{ pattern: regExpConfig.pwd, message: '密码只能是6-16个数字或者字母组成' }\r\n                                  { pattern: \"[A-Za-z0-9]{5,10}\", message: '密码只能为5-10位字符' }\r\n                              ],\r\n                              // validateTrigger: 'onBlur',\r\n                          })(\r\n                              <Input\r\n                                  prefix={<Icon type=\"lock\" style={{ fontSize: 13 }} />}\r\n                                  placeholder=\"请输入密码\"\r\n                                  type=\"password\"\r\n                              />\r\n                          )}\r\n                      </FormItem>\r\n                      <FormItem>\r\n                          {getFieldDecorator('remember', {\r\n                              valuePropName: 'checked',\r\n                              initialValue: true,\r\n                          })(\r\n                              <Checkbox>记住我</Checkbox>\r\n                          )}\r\n                          <a className=\"login-form-forgot\" href=\"\" style={{float: 'right'}}>忘记密码</a>\r\n                          <Button type=\"primary\" htmlType=\"submit\" className=\"login-form-button\" style={{width: '100%'}}>\r\n                              登录\r\n                          </Button>\r\n                          或 <a href=\"/#/register\" >现在就去注册!</a>\r\n\r\n                      </FormItem>\r\n                  </Form>\r\n                  </div>\r\n              </div>\r\n\r\n\r\n      );\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// handleSubmit (e) {\r\n//     e.preventDefault();\r\n//\r\n//     this.props.form.validateFields((err, values) => {\r\n//         if (!err) {\r\n//             post('http://localhost:3000/login', values)\r\n//                 .then((res) => {\r\n//                     if (res) {\r\n//                         message.info('登录成功');\r\n//                         this.context.router.push('/');\r\n//                     } else {\r\n//                         message.info('登录失败，账号或密码错误');\r\n//                     }\r\n//                 });\r\n//         }\r\n//     });\r\n// }\n\n\n// WEBPACK FOOTER //\n// ./app/containers/App/login.js","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../node_modules/css-loader/index.js!../../node_modules/postcss-loader/index.js!../../node_modules/less-loader/index.js!./login.less\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// add the styles to the DOM\nvar update = require(\"!../../node_modules/style-loader/addStyles.js\")(content, {});\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../node_modules/css-loader/index.js!../../node_modules/postcss-loader/index.js!../../node_modules/less-loader/index.js!./login.less\", function() {\n\t\t\tvar newContent = require(\"!!../../node_modules/css-loader/index.js!../../node_modules/postcss-loader/index.js!../../node_modules/less-loader/index.js!./login.less\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./app/style/login.less\n// module id = 1266\n// module chunks = 12"],"sourceRoot":""}